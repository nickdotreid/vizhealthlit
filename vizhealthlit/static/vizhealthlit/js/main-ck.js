function csrfSafeMethod(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function draw(e,t){$("#chart").html("");var n=$("#chart").parent();$("#chart").css({position:"fixed",top:n.position().top,left:n.position().left,width:n.width()});$("#chart").height($(window).height()-$(".navbar").height());visualization_functions[t.style]?visualization_functions[t.style](e,t):alert("no draw funciton")}var csrftoken=$.cookie("csrftoken");$.ajaxSetup({crossDomain:!1,beforeSend:function(e,t){csrfSafeMethod(t.type)||e.setRequestHeader("X-CSRFToken",csrftoken)}});$.fn.serializeObject=function(){var e={},t=this.serializeArray();$.each(t,function(){if(e[this.name]!==undefined){e[this.name].push||(e[this.name]=[e[this.name]]);e[this.name].push(this.value||"")}else e[this.name]=this.value||""});return e};var visualization_functions={};$(document).ready(function(){$(".control-viz a").click(function(e){e.preventDefault();$(".active",$(this).parents(".control-viz")).removeClass("active");$(this).parent().addClass("active")})});$(document).ready(function(){$(window).resize();$("body").delegate("form","submit",function(e){e.preventDefault();var t=$(this);$.ajax({url:t.attr("action"),type:t.attr("method"),data:t.serializeArray(),success:function(e){if(e.form){t.after(e.form);t.remove()}if(e.items){t.data("items",e.items);draw(e.items,t.serializeObject())}}})}).delegate("form input,form select","change",function(){var e=$(this).parents("form");e.data("items")&&draw(e.data("items"),e.serializeObject())})});