function draw_bars(e,t){function l(){function o(e){var n=0;e.sentences?3<=e.sentences.length<=5&&(n+=1):(!t.words_threshold_min||t["words_threshold_min"]==""||t.words_threshold_min<=e.words.length)&&(!t.words_threshold_max||t["words_threshold_max"]==""||t.words_threshold_max>=e.words.length)&&(n+=1);console.log(n);return n}e.selectAll("rect").data(function(e){return e.sentences}).enter().append("rect").attr({width:a,height:function(e){return u(e.length)},fill:function(e){return i(e.score)}});var r=0;e[0].forEach(function(e){ypos=0;l=0;d3.select(e).selectAll("rect").attr({x:function(e){if(n)return 0;l+=a;return l-a},y:function(e){if(!n){var t=Math.abs(this.getBoundingClientRect().top-this.getBoundingClientRect().bottom),r=0-t/2;r+=t*o(e);return r}var r=ypos;ypos+=this.getBBox().height;return r}})});var l=0;e.attr("transform",function(e){u=0;n&&(u=0-this.getBBox().height/2);n&&(u+=this.getBBox().height/4*o(e));var t="translate("+l+","+u+")";l+=this.getBBox().width;return t});f.attr("transform",function(){var e=s.width()/2-this.getBBox().width/2,t=s.height()/2-this.getBBox().height/2;return"translate("+e+","+t+")"})}var n=!0,r=[];e.forEach(function(e){e.sentences.forEach(function(t){t.paragraph=e;r.push(t)})});var i=d3.scale.linear().domain([d3.min(r,function(e){return e.score}),d3.max(r,function(e){return e.score})]).range(["#9b9b9b","#00ea13"]),s=$("#chart"),o=d3.select("#chart").append("svg:svg").attr("width",s.width()).attr("height",s.height()),u=d3.scale.linear().domain([0,d3.max(e,function(e){return e.length})]).range([0,s.height()/2]),a=s.width()/r.length;o.append("rect").attr({x:0,y:s.height()/2,width:s.width(),height:s.height()/2,fill:"#f5f5f5"});var f=o.append("g"),e=f.selectAll("g").data(e).enter().append("g");l();s.delegate("rect","click",function(){n?n=!1:n=!0;l()})}visualization_functions.bars=draw_bars;